{{ 'amz.css' | asset_url | stylesheet_tag }}
<section class="amz" style="margin:0 0 32px">
  {% if section.settings.title != blank %}<h2 style="font-weight:700; font-size:clamp(18px,2.2vw,24px); margin:0 0 12px">{{ section.settings.title }}</h2>{% endif %}
  <div class="amz-grid">
    {% if section.settings.collection != blank %}
      {% assign coll = collections[section.settings.collection] %}
      {% for product in coll.products limit: section.settings.limit %}
        <div class="amz-card">
          {% if product.featured_image %}
            {{ product.featured_image | image_url: width: 600 | image_tag: loading: 'lazy', alt: product.title }}
          {% endif %}
          <div class="content">
            <h3 style="font-weight:700; color:#111827; margin:0 0 8px">{{ product.title }}</h3>
            <div class="amz-price">
              <span class="now">{{ product.price | money }}</span>
              {% if product.compare_at_price > product.price %}
                <span class="was">{{ product.compare_at_price | money }}</span>
              {% endif %}
            </div>
            <div style="margin-top:auto">
              <a href="{{ product.url }}" class="cta" style="background:#111; color:#fff; display:inline-block; padding:8px 14px; border-radius:999px; font-weight:700; margin-top:8px">View</a>
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      {% comment %} Placeholder cards if no collection set {% endcomment %}
      {% for i in (1..4) %}
        <div class="amz-card"><img src="https://placehold.co/300x200/cccccc/333333?text=Product" alt="">
          <div class="content"><h3>Product Title</h3><div class="amz-price"><span class="now">$49.99</span></div></div>
        </div>
      {% endfor %}
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name":"Product Grid (4-col)",
  "settings":[
    { "type":"text","id":"title","label":"Heading","default":"Trending Now" },
    { "type":"collection","id":"collection","label":"Collection" },
    { "type":"range","id":"limit","label":"Products to show","min":4,"max":24,"step":4,"default":8 }
  ],
  "presets":[{ "name":"Product Grid (4-col)" }]
}
{% endschema %}
